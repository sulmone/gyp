{
  'variables': {
    'depth': '..',
  },
  'includes': [
    '../build/common.gypi',
  ],
  'targets': [
    {
      'target_name': 'v8',
      'type': 'static_library',
      'sources': [
        # TODO(mark): choose between libraries-empty.cc and libraries.cc
        # depending on snapshot.
        '<(INTERMEDIATE_DIR)/libraries.cc',
        'src/third_party/dtoa/dtoa.c',
        'src/third_party/jscre/ASCIICType.h',
        'src/third_party/jscre/config.h',
        'src/third_party/jscre/pcre.h',
        'src/third_party/jscre/pcre_chartables.c',
        'src/third_party/jscre/pcre_compile.cpp',
        'src/third_party/jscre/pcre_exec.cpp',
        'src/third_party/jscre/pcre_internal.h',
        'src/third_party/jscre/pcre_tables.cpp',
        'src/third_party/jscre/pcre_ucp_searchfuncs.cpp',
        'src/third_party/jscre/pcre_xclass.cpp',
        'src/third_party/jscre/ucpinternal.h',
        'src/third_party/jscre/ucptable.cpp',
        'src/accessors.cc',
        'src/accessors.h',
        'src/allocation.cc',
        'src/allocation.h',
        'src/api.cc',
        'src/api.h',
        'src/apinatives.js',
        'src/apiutils.h',
        'src/arguments.h',
        'src/array.js',
        'src/assembler-arm-inl.h',
        'src/assembler-arm.cc',
        'src/assembler-arm.h',
        'src/assembler-ia32-inl.h',
        'src/assembler-ia32.cc',
        'src/assembler-ia32.h',
        'src/assembler.cc',
        'src/assembler.h',
        'src/ast.cc',
        'src/ast.h',
        'src/bootstrapper.cc',
        'src/bootstrapper.h',
        'src/builtins-arm.cc',
        'src/builtins-ia32.cc',
        'src/builtins.cc',
        'src/builtins.h',
        'src/bytecodes-irregexp.h',
        'src/char-predicates-inl.h',
        'src/char-predicates.h',
        'src/checks.cc',
        'src/checks.h',
        'src/code-stubs.cc',
        'src/code-stubs.h',
        'src/code.h',
        'src/codegen-arm.cc',
        'src/codegen-arm.h',
        'src/codegen-ia32.cc',
        'src/codegen-ia32.h',
        'src/codegen-inl.h',
        'src/codegen.cc',
        'src/codegen.h',
        'src/compilation-cache.cc',
        'src/compilation-cache.h',
        'src/compiler.cc',
        'src/compiler.h',
        'src/constants-arm.h',
        'src/contexts.cc',
        'src/contexts.h',
        'src/conversions-inl.h',
        'src/conversions.cc',
        'src/conversions.h',
        'src/counters.cc',
        'src/counters.h',
        'src/cpu-arm.cc',
        'src/cpu-ia32.cc',
        'src/cpu.h',
        'src/date-delay.js',
        'src/dateparser.cc',
        'src/dateparser.h',
        'src/debug-arm.cc',
        'src/debug-delay.js',
        'src/debug-ia32.cc',
        'src/debug.cc',
        'src/debug.h',
        'src/disasm-arm.cc',
        'src/disasm-ia32.cc',
        'src/disasm.h',
        'src/disassembler.cc',
        'src/disassembler.h',
        'src/dtoa-config.c',
        'src/execution.cc',
        'src/execution.h',
        'src/factory.cc',
        'src/factory.h',
        'src/flag-definitions.h',
        'src/flags.cc',
        'src/flags.h',
        'src/frames-arm.cc',
        'src/frames-arm.h',
        'src/frames-ia32.cc',
        'src/frames-ia32.h',
        'src/frames-inl.h',
        'src/frames.cc',
        'src/frames.h',
        'src/global-handles.cc',
        'src/global-handles.h',
        'src/globals.h',
        'src/handles-inl.h',
        'src/handles.cc',
        'src/handles.h',
        'src/hashmap.cc',
        'src/hashmap.h',
        'src/heap-inl.h',
        'src/heap.cc',
        'src/heap.h',
        'src/ic-arm.cc',
        'src/ic-ia32.cc',
        'src/ic-inl.h',
        'src/ic.cc',
        'src/ic.h',
        'src/interpreter-irregexp.cc',
        'src/interpreter-irregexp.h',
        'src/jsregexp-inl.h',
        'src/jsregexp.cc',
        'src/jsregexp.h',
        'src/list-inl.h',
        'src/list.h',
        'src/log.cc',
        'src/log.h',
        'src/macro-assembler-arm.cc',
        'src/macro-assembler-arm.h',
        'src/macro-assembler-ia32.cc',
        'src/macro-assembler-ia32.h',
        'src/macro-assembler.h',
        'src/macros.py',
        'src/mark-compact.cc',
        'src/mark-compact.h',
        'src/math.js',
        'src/memory.h',
        'src/messages.cc',
        'src/messages.h',
        'src/messages.js',
        'src/mirror-delay.js',
        'src/natives.h',
        'src/objects-debug.cc',
        'src/objects-inl.h',
        'src/objects.cc',
        'src/objects.h',
        'src/parser.cc',
        'src/parser.h',
        'src/platform-freebsd.cc',
        'src/platform-linux.cc',
        'src/platform-macos.cc',
        'src/platform-nullos.cc',
        'src/platform-win32.cc',
        'src/platform.h',
        'src/prettyprinter.cc',
        'src/prettyprinter.h',
        'src/property.cc',
        'src/property.h',
        'src/regexp-delay.js',
        'src/regexp-macro-assembler-arm.cc',
        'src/regexp-macro-assembler-arm.h',
        'src/regexp-macro-assembler-ia32.cc',
        'src/regexp-macro-assembler-ia32.h',
        'src/regexp-macro-assembler-irregexp-inl.h',
        'src/regexp-macro-assembler-irregexp.cc',
        'src/regexp-macro-assembler-irregexp.h',
        'src/regexp-macro-assembler-tracer.cc',
        'src/regexp-macro-assembler-tracer.h',
        'src/regexp-macro-assembler.cc',
        'src/regexp-macro-assembler.h',
        'src/regexp-stack.cc',
        'src/regexp-stack.h',
        'src/rewriter.cc',
        'src/rewriter.h',
        'src/runtime.cc',
        'src/runtime.h',
        'src/scanner.cc',
        'src/scanner.h',
        'src/scopeinfo.cc',
        'src/scopeinfo.h',
        'src/scopes.cc',
        'src/scopes.h',
        'src/serialize.cc',
        'src/serialize.h',
        'src/shell.h',
        'src/smart-pointer.h',
        'src/snapshot-common.cc',
        # TODO(mark): choose between snapshot-empty.cc and snapshot.cc
        # generated by mksnapsot.
        'src/snapshot-empty.cc',
        'src/snapshot.h',
        'src/spaces-inl.h',
        'src/spaces.cc',
        'src/spaces.h',
        'src/string-stream.cc',
        'src/string-stream.h',
        'src/string.js',
        'src/stub-cache-arm.cc',
        'src/stub-cache-ia32.cc',
        'src/stub-cache.cc',
        'src/stub-cache.h',
        'src/token.cc',
        'src/token.h',
        'src/top.cc',
        'src/top.h',
        'src/unicode-inl.h',
        'src/unicode.cc',
        'src/unicode.h',
        'src/uri.js',
        'src/usage-analyzer.cc',
        'src/usage-analyzer.h',
        'src/utils.cc',
        'src/utils.h',
        'src/v8-counters.cc',
        'src/v8-counters.h',
        'src/v8.cc',
        'src/v8.h',
        'src/v8natives.js',
        'src/v8threads.cc',
        'src/v8threads.h',
        'src/variables.cc',
        'src/variables.h',
        'src/zone-inl.h',
        'src/zone.cc',
        'src/zone.h',
      ],
      'sources!': [
        # These files are #included by others and are not meant to be compiled
        # directly.
        'src/third_party/dtoa/dtoa.c',
        'src/third_party/jscre/pcre_chartables.c',
        'src/third_party/jscre/ucptable.cpp',
      ],
      'sources/': [
        ['exclude', '-arm\\.cc$'],
        ['exclude', '^src/platform-.*\\.cc$' ],
      ],
      'conditions': [
        # TODO(mark): These only need to be 'sources/', the extra '+' is
        # for prepend, which is only temporary until the rules scanner is
        # rewritten to not pull things out of the list until all includes and
        # excludes are processed.
        ['OS=="linux"', {'sources/+': [['include', '^src/platform-linux\\.cc$']]}],
        ['OS=="mac"', {'sources/+': [['include', '^src/platform-macos\\.cc$']]}],
        ['OS=="win"', {'sources/+': [['include', '^src/platform-win32\\.cc$']]}],
      ],
      'include_dirs': [
        'src',
      ],
      'actions': [
        {
          'action_name': 'js2c',
          'inputs': [
            'src/runtime.js',
            'src/v8natives.js',
            'src/array.js',
            'src/string.js',
            'src/uri.js',
            'src/math.js',
            'src/messages.js',
            'src/apinatives.js',
            'src/debug-delay.js',
            'src/mirror-delay.js',
            'src/date-delay.js',
            'src/regexp-delay.js',
            'src/macros.py',
            'tools/js2c.py',
          ],
          'outputs': [
            '<(INTERMEDIATE_DIR)/libraries.cc',
            '<(INTERMEDIATE_DIR)/libraries-empty.cc',
          ],
          'action': 'tools/js2c.py "<(INTERMEDIATE_DIR_SCRIPT)/libraries.cc" "<(INTERMEDIATE_DIR_SCRIPT)/libraries-empty.cc" CORE src/v8natives.js src/array.js src/string.js src/uri.js src/math.js src/messages.js src/apinatives.js src/debug-delay.js src/mirror-delay.js src/date-delay.js src/regexp-delay.js src/macros.py'
        },
      ],
    },
  ],
}
